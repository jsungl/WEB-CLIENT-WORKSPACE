<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>js - window</title>
    <style>
        #clock {
            font-size: 3em;
            text-shadow: 3px 3px 7px black;
        }
        #countdown {
            border: 3px solid black;
            font-size: 15em;
            padding: 10px;
            text-align: center;
            display:none;
        }
    </style>
</head>
<body onload="test5();">
    <h1>Window</h1>
    <h2>웹페이지 구조</h2>
    <img src="images/windowObjects.png" alt="">
    <h2>Method</h2>
    <input type="button" value="open" onclick="test1();">
    <input type="button" value="popup 닫기" onclick="test2();">
    <input type="button" value="setTimeout" onclick="test3();">
    <input type="button" value="실습문제" onclick="test4();">
    <input type="button" value="setInterval" onclick="test5();">
    <input type="button" value="countdown" onclick="test6();">

    <hr>
    <div id="clock">16:55:10</div>
    <div id="countdown"></div>
    <script>
        /**
         * open 새로운 window생성
         * - 새탭
         * - 팝업창
         * 
         * open(url, name, specs)
         * - specs 문자열
         * - name 팝업창이름, _self로 작성하면 현재탭에서 열림
         */

         //팝업으로 새창열기
        function test1() {
            //완전독립적인 새로운 window객체 : 버튼을 계속누르면 새로운 window창이 계속 열리는것이아니고 열려있는 name을 찾아서 해당창을 연다
            w = open("13_object.html","newWindow", "width=800, height=500, top=300, left=300"); //팝업창
            //w = open("13_object.html","",""); //새탭
            
            console.log(w); //팝업창의 window
            console.log(window == w); //false
            //w.alert("새로운팝업창");
            //1초 이후 실행
            setTimeout(function() {
                w.alert('새로운팝업창');
            },1000);
        }

        var w;
        function test2() {
           w && w.close();
        };

        /**
         * setTimeout(callbackFunction, millis);
         * millis초이후에 callbackFunction을 실행
         * timeoutAPI의 메소드는 비동기적으로 처리된다
         */
        function test3() {
            setTimeout(function() {
                alert('반갑습니다');
            },3000); //3초이후 실행

            alert('안녕'); //먼저실행됨.비동기적으로 처리된다 <->동기적(위에서 아래로, 좌에서 우로 순서대로 처리)
            
        };

        /**
         * 실습문제
         * 팝업창을 열고 <h1>3초 팝업</h1>을 작성
         * 3초이후에 자동으로 창이 닫히도록 하세요
         * open("","","spec")
         */
        function test4() {
            var w2 = open("","popup", "width=800, height=500, top=300, left=300");
            //w2.document.querySelector("body").innerHTML = "<h1>3초팝업</h1>";
            w2.document.write("<h1>3초팝업</h1>");
            setTimeout(function() {
                w2.close();
            },3000);
        }

        /**
         * setInterval(callbackFunction,millis)
         * millis초마다 callbackFunction을 실행
         */
        function test5() {
            //var num = 1;

            var foo = function() {
                var now = new Date();
                var strFormat = getTimeFormatStr(now);
                document.querySelector('#clock').innerHTML = strFormat;
            };
            foo();
            setInterval(foo,1000);
            // setInterval(function() {
            //     // console.log(num++);
            //     //시계만들기
            //     var now = new Date();
            //     var strFormat = getTimeFormatStr(now);
            //     document.querySelector('#clock').innerHTML = strFormat;
            // },1000);
        }

        function getTimeFormatStr(time) {
            //2자리 만들기 : 9 -> 09
            var f = function(n) {
                return n >= 10 ? n : "0"+n;
            }
            var hh = f(time.getHours());
            var mi = f(time.getMinutes());
            var ss = f(time.getSeconds());
            return hh + ":" + mi + ":" + ss;
        }

        function test6() {
            var num = document.querySelector('#countdown');
            var cnt = 10;
            num.style.display = 'block';
            var intervalId = setInterval(function() {
                //console.log(num);
                num.innerText = cnt--;
                if(cnt < 0){
                    clearInterval(intervalId); //0에서 카운트다운 정지
                }
            },1000); //1초후 실행
            console.log(intervalId); //2,  먼저실행됨
        }

    </script>

    <h2>BOM</h2>
    <h3>Browser Object Model</h3>
    <input type="button" value="navigator" onclick="test7();">
    <input type="button" value="location" onclick="test8();">
    <input type="button" value="history" onclick="test9();">
    <input type="button" value="screen" onclick="test10();">
    <script>
        /**
         * navigator : 현재실행중인 browser에 대한 정보를 가진 객체
         */
        function test7() {
            console.log(navigator);
        }

        /**
         * location : 주소창 관련 정보를 가진 객체
         */
        function test8() {
            console.log(location);
            //페이지 새로고침
            //location.reload();

            //페이지 이동(현재페이지)
            location.href = "https://www.naver.com";
        }

        /**
         * history : 방문기록 관련 정보를 가진 객체
         * 
         * back() : 뒤로가기
         * forward() : 앞으로가기
         * go(n) : -1 | 0 | 1
         */
        function test9() {
            console.log(history);
            //history.back(); 
            history.forward();
            //history.go(1)
        }

        /**
         * screen : 모니터 관련 정보를 가진 객체
         * -width
         * -height
         * -availWidth
         * -availHeight
         */
        function test10() {
            console.log(screen);

            var w = 300;
            var h = 300;
            var left = (screen.availWidth - w) / 2;
            var top = (screen.availHeight - h) / 2;

            open("","popup","width=300, height=300, left=" + left + ",top=" + top); //가운데띄우기
        }
    </script>

    <h2>DOM</h2>
    <input type="button" value="Node" onclick="test11();">
    <div class="img-wrapper"></div>
    <script>
        /**
         * Node객체 : 모든 DOM객체가 Node객체를 상속받는다.
         * 
         * H2 - HTMLHeadingElement - HTMLElement - Element - Node - EventTarget - Object
         * 
         * - firstChild | lastChild | childNodes...
         * - contains() | appendChild() | removeChild()...
         */
        function test11() {
            var h2 = document.querySelector("h2:last-of-type");
            console.log(h2);
            //console.dir(h2);
            
            //img태그 동적으로 생성
            var img = document.createElement("img");
            img.src = "images/windowObjects.png";
            img.style = "width:200px";
            console.log(img);

            document.querySelector(".img-wrapper").appendChild(img);
            // 문자로 처리할때
            // document.querySelector(".img-wrapper").innerHTML += '<img src="images/windowObjects.png" style="width: 200px;">';

        }
    </script>   
</body>
</html>