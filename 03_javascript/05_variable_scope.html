<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>js - variable | scope</title>
</head>
<body>
    <h1>Variable | Scope</h1>
    <input type="button" value="전역 | 지역" onclick="test1();">
    <input type="button" value="scope" onclick="test2();">
    <input type="button" value="개선" onclick="test3();">
    <script>
        //함수 밖 script태그에 작성된 var변수는 전역변수로 등록된다
        //최상위객체 window의 속성으로 등록된다
        var a;
        a = 100; //변수의 타입이 결정

        /** 
         * 함수안에 var변수는 지역변수로 등록된다
         * 함수밖에서는 절대 접근할수없다
         */
        function test1() {
            //함수실행이 끝나면 메모리가 날라간다
            var a = "아";
            //var a = true; //중복선언가능
            var b = 123; 
            //동일한이름일경우 가까운것이 우선순위가 높다
            console.log("a = " + a); //아 
            console.log("b = " + b); //123
            //(this용법2) 일반함수안에서 this는 window객체를 가리킨다
            console.log("전역변수 a = " + this.a); //전역변수 호출(window.a도 동일)
            
            //var없이 선언된 변수는 함수안이래도 전역변수(window의 속성으)로 등록된다
            c = 'ㅋㅋㅋㅋ'; 
            console.log(c);   
        }


        /**
         * scope : 유효범위
         * c-family언어가 가진 block scope가 아닌
         * javascript에서는 function scope를 가진다
         */ 
        function test2() {
            var x = 10;

            if(true) {
                var x = 100;
            }

            console.log(x); //100 : 함수안이면 같은 범위라고 생각한다
            
            for(var i = 0; i < 10; i++){

            }
            console.log(i); //10 for문 블럭안에서 선언됐지만 접근가능
            
            var k = 123.456;
            if(true){
                var k = 456.789;
            }
            console.log(k); //456.789
        }

        /**
         * use strict : 엄격모드 지원
         * 
         * ES6지원
         * let - block scope를 가진 변수 키워드
         * const - block scope를 가진 상수 키워드
         */
        function test3() {
            "use strict";
            x = 100;
            //var키워드없어서 컴파일오류발생
            console.log(x); //Uncaught ReferenceError: x is not defined
            
            let foo = 100;
            let foo = 200; //Uncaught SyntaxError: Identifier 'foo' has already been declared

            const bar = '상수';
            bar = '변수냐'; //Uncaught TypeError: Assignment to constant variable.
        }
    </script>
</body>
</html>