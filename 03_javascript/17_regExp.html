<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>js - regExp</title>
    <style>
        #area {
            margin: 30px 10px;
        }
        
    </style>
</head>
<body>
    <h1>정규표현식</h1>
    <input type="button" value="기본" onclick="test1();">
    <input type="button" value="flag -  g | i | m" onclick="test2();">
    <input type="button" value="anchor - ^ | $" onclick="test3();">
    <input type="button" value="실습문제1" onclick="test4();">
    <input type="button" value="." onclick="test5();">
    <input type="button" value="[]" onclick="test6();">
    <input type="button" value="실습문제2" onclick="test7();">
    <input type="button" value="\d \w \s" onclick="test8();">
    <input type="button" value="( | )" onclick="test9();">
    <input type="button" value="escaping" onclick="test10();">
    <input type="button" value="* + ?" onclick="test11();">
    <input type="button" value="{n,m}" onclick="test12();">
    <input type="button" value="look around" onclick="test13();">

    <div id="area"></div>
    <script>
        /**
         * 정규표현식
         * 특정규칙을 가진 문자열 집합에 대한 형식언어
         * 유효성검사, 검색, 문자열치환 처리등을 효율적으로 할수있다
         * 간결한 코드를 만드는 표현식 숙지가 쉽지않다
         * 언어독립적
         */
        function test1() {
            //객체생성
            var re1 = /a/; //a가 포함되있는지 확인
            var re2 = new RegExp(/[0-9]/); //숫자가 포함되있는지 확인
            var re3 = new RegExp("[a-z]"); //영소문자가 포함되있는지 확인

            //test() : return boolean
            console.log(re1.test('abcde')); //true
            console.log(re1.test('bdfoe')); //false
            
            console.log(re2.test('hoggd123')); //true
            console.log(re2.test('hoggd')); //false

            console.log(re3.test('가나다ABc123')); //true
            console.log(re3.test('가나다ABC123')); //false

            //exec() : return []
            console.log(re1.exec('abcde')); //["a", index: 0, input: "abcde", groups: undefined]

            //문자열
            //match
            console.log('cba'.match(re1)); //["a", index: 2, input: "cba", groups: undefined]
            //search 해당인덱스
            console.log('cba'.search(re1)); //2
            //replace
            console.log('cbfefaefdsa'.replace(/a/g, 'A')); //a를 A로 교체  cbfefAefdsA
            //split
            console.log('사과,배,양파,마늘'.split(/,/)); //["사과", "배", "양파", "마늘"]

            console.log('사과,배, 양파, 마늘'.split(/\s*,\s*/)); //["사과", "배", "양파", "마늘"]
            console.log('사과,배, 양파, 마늘'.replace(/ /g,"").split(/,/));
        }

        /**
         * flag문자
         * g : global 전역비교를 수행. 이게없으면 첫 매칭만 처리. g가 있으면 여러건 처리
         * i : ignore 영문자중에 대소문자를 구분하지않고 비교수행
         * m : multi-line 여러줄(\n)이 있는경우 줄단위 비교수행
         */
        function test2() {
            var str = 'Javascript jQuery Ajax';
            // $&는 매칭된 text를 가리키는 wildcard(대체문자)
            area.innerHTML = str.replace(/a/gi, '<mark>$&</mark>');
            //area.innerHTML = str.replace(new RegExp("a","gi"), '<mark>$&</mark>');
        }

        /**
         * anchor문자
         * ^ : 문자열시작
         * $ : 문자열 끝
         */
        function test3() {
            var str = 'Javascript\nxxx\njQuery\nAjax';
            area.innerHTML = str.replace(/^j/ig, "<mark>$&</mark>"); //문자열 시작첫글자가 j인경우
            //area.innerHTML = str.replace(/x$/ig, "<mark>$&</mark>"); //문자열 끝글자가 x인경우
            //area.innerHTML = str.replace(/x$/igm, "<mark>$&</mark>"); //각줄에서 끝글자가 x인경우
        }

        /**
         * 사용자로부터 문자열을 입력받고 
         * k로 시작하면서 h로 끝나는 경우에는 잘하셨습니다
         * 아닌 경우 적합한 문자가 아닙니다 경고창을 띄우세요
         */
        function test4() {
            var str = prompt("아무문자나 입력");
            var re1 = /^k/ig;
            var re2 = /h$/ig;

            if(re1.test(str) && re2.test(str)){
                alert('잘하셨습니다');    
            }else
                alert('적합한문자가 아닙니다');
        }

        /**
         * . 포인트 : 임의의 한글자를 의미
         */
        function test5() {
            var re1 = /^...$/; //3글자인지검사
            //var re1 = /.../; //3글자인지검사
            //console.log(re1.test('ab')); //false
            //console.log(re1.test('abc')); //true
            //console.log(re1.test('abcd')); //false
            //console.log(re1.test('a b')); //true(공백도 하나의 글자로 본다)

            var re2 = /a.b/g;
            area.innerHTML = "ab aab aaab".replace(re2, "<mark>$&</mark>");

            var re3 = /in..$/; //in이후 두글자로 끝나는 문자열 검사
            ["goingo", "goin", "gointo", "going"].forEach(function(s){
                console.log(re3.test(s)); //true false true false
            });     


            var re4 = /^c...k$/; //c로 시작하고 k로 끝나는 총 5글자인 문자열 검사 
            ["ck", "cbk", "cbak", "cbawk", "cbawak"].forEach(function(s){
                console.log(re4.test(s)); //false false false true false
            });

        }


        /**
         * []
         * 한글자를 의미하며 문자의 범위를 나타냄
         * 대괄호안에 사용된 ^는 특정문자 제외를 의미
         */
        function test6() {
            var s = "Javascript jQuery Ajax 12345";
            //area.innerHTML = s.replace(/[ajq]/g, "<mark>$&</mark>"); //a또는j또는q
            //area.innerHTML = s.replace(/[^aj]/g, "<mark>$&</mark>"); //a또는j가 아닌문자(공백포함)
            //area.innerHTML = s.replace(/[A-Z]/g, "<mark>$&</mark>"); //영문 대문자
            //area.innerHTML = s.replace(/[0-9]/g, "<mark>$&</mark>"); //숫자
            //area.innerHTML = s.replace(/[A-Za-z]/g, "<mark>$&</mark>"); //영문자
           // area.innerHTML = s.replace(/[A-Za-z0-9 ]/g, "<mark>$&</mark>"); //영문자 + 숫자 + 공백

            var hangul = "안녕하세요. James입니다. I love 서울";
            //area.innerHTML = hangul.replace(/[가-힣]/g, "<mark>$&</mark>");
            //area.innerHTML = hangul.replace(/[ㄱ-ㅎㅏ-ㅣ가-힣]/g, "<mark>$&</mark>"); //한글(자음,모음포함)
        }

        /**
         * 1. 사용자로부터 숫자로 시작되지 않는 id검사
         * 2. 숫자 4자리인 비밀번호 여부 검사
         * 
         * 유효하지않는경우 alert창 띄우기
         */
        function test7() {
            var id;
            id = prompt('id입력');
            if(/^[0-9]/.test(id)){
                alert('아이디는 숫자로 시작할수없습니다');
                return;
            }

            var pwd;
            pwd = prompt('비밀번호입력');
            if(!(/^[0-9][0-9][0-9][0-9]$/.test(pwd))){
                alert('비밀번호는 숫자4자리여야합니다');
                return;
            }
        }


        /**
         * \d : decimal 숫자 
         * \w : word 영문자,숫자,_
         * \s : space 공백문자, 탭, 개행문자
         * 
         * 반전
         * \D : 숫자가아닌문자
         * \W : 영문자,숫자,_ 가 아닌 문자
         * \S : 공백문자,탭,개행문자가 아닌 문자
         */
        function test8() {
            var s = "A1 B2 c3 d_4 e:5' ` ffGG6767--___--!@#$%^&*()                  가\n나\n다\ns";

            //area.innerHTML = s.replace(/\d/g, "<mark>$&</mark>"); //숫자
            //area.innerHTML = s.replace(/\w/g, "<mark>$&</mark>"); //영문자,숫자,_
           //area.innerHTML = s.replace(/\s/g, "<mark>$&</mark>"); //공백문자, 탭, 개행문자
            
            //area.innerHTML = s.replace(/\D/g, "<mark>$&</mark>"); 
            //area.innerHTML = s.replace(/\W/g, "<mark>$&</mark>"); 
            //area.innerHTML = s.replace(/\S/g, "<mark>$&</mark>"); 
            
            //area.innerHTML = s.replace(/[0-9]/g, "<mark>$&</mark>"); //숫자
            //area.innerHTML = s.replace(/[A-Za-z0-9_]/g, "<mark>$&</mark>"); //영문자,숫자,_
            //area.innerHTML = s.replace(/[ \t\n]/g, "<mark>$&</mark>"); //공백문자, 탭, 개행문자
            
            //area.innerHTML = s.replace(/[^0-9]/g, "<mark>$&</mark>"); //숫자제외
            //area.innerHTML = s.replace(/[^A-Za-z0-9_]/g, "<mark>$&</mark>"); 
            //area.innerHTML = s.replace(/[^ \t\n]/g, "<mark>$&</mark>");


        }

        /**
         * () : grouping
         * | : or
         */
        function test9(params) {
            var s = "월요일에는 월요병, 화요일은 화가 부글부글, " 
                    + "수요일은 술이 확 땡긴다. 목요일이 목이 컥 막히고, 금요일은 금방 올거 같지 않다.";
            
            //수요일 또는 목요일 또는 금요일
            //area.innerHTML = s.replace(/(수요일|목요일|금요일)/g,"<mark>$&</mark>"); 
            //area.innerHTML = s.replace(/[수목금]요일/g,"<mark>$&</mark>");
            //area.innerHTML = s.replace(/(수|목|금)요일/g,"<mark>$&</mark>");

        }

        /**
         * escaping 
         * 메타문자($)를 실제문자값으로 사용하려면  \(역슬래시)를 통해 escaping처리한다
         * []안에서는 escaping필요없음. ^은 첫째자리에 사용하지말것.
         */
        function test10() {
            var s = "$12$ \\-\\ $25$";
            //area.innerHTML = s.replace(/\$/g, "<mark>$&</mark>");
            //area.innerHTML = s.replace(/^\$/g, "<mark>$&</mark>"); //시작하는 $하나
            //area.innerHTML = s.replace(/\$$/g, "<mark>$&</mark>"); //끝나는 $하나

        }


        /**
         * 수량자
         * a* : a가 0개이상
         * a+ : a가 1개이상
         * a? : a가 0 또는 1 개
         */
        function test11() {
            var s = "aabc abc bc";
            //area.innerHTML = s.replace(/a*b/g, "<mark>$&</mark>"); //b앞에 a가0개이상있는경우
            //area.innerHTML = s.replace(/a+b/g, "<mark>$&</mark>"); //b앞에 a가1개이상있는경우
            //area.innerHTML = s.replace(/a?b/g, "<mark>$&</mark>"); //b앞에 a가0개또는1개
        }

        /**
         * 수량표현
         * a{5} : a가 5번
         * a{2,5} : a가 2~5개
         * a{3,} : a가 3개이상
         * 
         * a{,4} 이문법은 존재하지않음
         * 
         */
        function test12() {
            var s = "aa aba abba abbba";
            //area.innerHTML = s.replace(/ab{2}a/g, "<mark>$&</mark>");
            //area.innerHTML = s.replace(/ab{1,2}a/g, "<mark>$&</mark>");
            //area.innerHTML = s.replace(/ab{2,}a/g, "<mark>$&</mark>");

             area.innerHTML = s.replace(/ab*a/g, "<mark>$&</mark>");
            // area.innerHTML = s.replace(/ab{0,}a/g, "<mark>$&</mark>");
            // area.innerHTML = s.replace(/ab+a/g, "<mark>$&</mark>");
            // area.innerHTML = s.replace(/ab{1,}a/g, "<mark>$&</mark>");
            //area.innerHTML = s.replace(/ab?a/g, "<mark>$&</mark>");
            //area.innerHTML = s.replace(/ab{0,1}a/g, "<mark>$&</mark>");

            //숫자로 시작하고 영문자 3글자 이상 나오고 .마침표로 끝나는 문자열을 검사하는 정규식표현
            // true : 1abc안녕하세요. 3xyzkkk. 1ABC.
            // false : 100 1cbㅋㅋㅋ. 아아아아. 
            ["1abc안녕하세요..", "3xyzkkk.", "1ABC."].forEach(function(s){
                console.log(/^\w[A-Za-z]{3,}.*\.$/.test(s)); // true
            });

            ["100", "1cbㅋㅋㅋ.", "아아아아.", "1가나다abc.", "123abc다나가."].forEach(function(s){
                console.log(/^\w[A-Za-z]{3,}.*\.$/.test(s)); // false
            });    

        }

        /**
         * look around : 문자열 검사후 최종패턴에는 포함되지않는다
         * 
         * 1. look ahead
         *  -000(?=(re)) : 000다음 re일치. 000만 최종반환
         *  -000(?!(re)) : 000다음 re일치하지않아야함. 000만 최종반환
         * 2. look behind
         *  -(?<=(re))000 : 000이전 re일치. 000만 최종반환
         *  -(?<!(re))000 : 000이전 re일치하지않아야함. 000만 최종반환
         */
        function test13() {
            var s = "hello world hello Tom hello Jane";
            //area.innerHTML = s.replace(/hello(?=(\sworld))/g, '<mark>$&</mark>');
            //area.innerHTML = s.replace(/hello(?!\sworld)/g, '<mark>$&</mark>');
            s = "hello world lotte world t world";
            //area.innerHTML = s.replace(/(?<=hello\s)world/g, '<mark>$&</mark>');
            area.innerHTML = s.replace(/(?<!hello\s)world/g, '<mark>$&</mark>');

        }
    </script>
    <form action="">
        <fieldset>
            <legend>아이디 유효성 검사</legend>
            <input type="text" id="userId" name="userId" placeholder="아이디">
            <input type="submit" value="제출">
        </fieldset>
    </form>

    <script>
        /**
         * userId가 8~12자리, 영문자/숫자/특수문자 1개이상 포함, 영문자로 시작할때만 유효
         * 유효하지않다면 폼이 제출되어서는 안된다
         */
        document.querySelector('form').onsubmit = function() {
            var val = userId.value;
            //userId가 8~12자리
            if(/^.{8,12}$/.test(val) == false){
                alert('아이디는 8~12자리여야 합니다');
                return false;
            }
            //2.영문자/숫자/특수문자 하나이상 포함
            if( ((/[a-zA-Z]/.test(val)) && (/[0-9]/.test(val)) && (/[!@#$%^&*()]/.test(val))) == false ){
                alert("아이디는 영문자/숫자/특수문자 *!^/@$ 하나이상 포함해야 합니다.");
                return false;
            }
            //3.영문자로 시작할때
            if(/^[a-zA-Z]/.test(val) == false){
                alert("아이디는 영문자로 시작해야 합니다.");
                return false;
            }
        };
    </script>
</body>
</html>