<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>js - event</title>
    <script>
        /**
         * 현재페이지 모든 설정이 끝난후 load이벤트 발생
         */
        window.onload = function() {
            // document.querySelector("#btn2").onmouseover = function() {
            //     alert('123');
            // };       
        }
    </script>
</head>
<body>
    <h1>Event</h1>
    <a href="https://www.w3schools.com/jsref/dom_obj_event.asp">HTML DOM EVENTs</a>
    <h2>Event Handler Binding</h2>
    <input type="button" value="inline event 속성" onclick="test1();" onmouseover="test1();">
    <input type="button" value="event속성 지정" id="btn2">
    <input type="button" value="addEventListener" id="btn3">
    
    <script>
        function test1() {
            console.log('inline event 발생');
        }

        document.querySelector('#btn2').onclick = function() {
            console.log('#btn2 click envent 발생');
        };

        //document.querySelector('#btn2').onclick = test1; //test1();으로 안하게 주의(함수자체를전달,호출x)

        //click이벤트가 들어오면 두번째인자인 함수를 실행
        document.querySelector('#btn3').addEventListener("click",function() {
            alert('#btn3 click event 발생');
        });
    </script>

    <h2>Event | Event Target</h2>
    <div class="box" onclick="test2(event);"></div>
    <style>
        .box {
            width: 100px;
            height: 100px;
            border: 3px solid black;
            background: blue;
            text-align: center;
            padding: 20px;
        }
    </style>
    <script>
        /**
         * Event 객체 : 발생한 이벤트관련 모든 정보를 가진 객체
         *              이벤트핸들러함수의 인자로 전달이 됨
         * Event Target객체 : 이벤트발생객체. Event객체의 target속성값
         */
        document.querySelector('.box').onmouseover = function(e) {
            console.log(e);
            // console.log(e.target == document.querySelector('.box')); //true

            e.target.innerHTML = '안녕';
            //(this용법5) event handler안에서 this는 event target객체를 가리킨다
            console.log(e.target == this);
            //this.innerHTML = '안녕'; 도 가능
        };

        /**
         * mouseover <-----> mouseout
         */
        document.querySelector('.box').onmouseout = function(e) {
            e.target.innerHTML = '잘가';
            //this.innerHTML = '잘가';
        };

        /**
         * html태그 inline속성으로 핸들러를 호출하는경우
         * 이 함수는 일반함수이고 this는 window객체를 가리킨다
         */
        function test2(e) {
            console.log(e);
            console.log(e.target); //div태그(.box)
            //console.log(e.target == this); //false
            console.log(this); //window
        }
    </script>

    <h2>KeyEvent</h2>
    <input type="text" id="userInput" placeholder="아무말...">
    <div class="text-wrapper" style="color: blueviolet;"></div>
    <script>
        /**
         * keydown - keypress - keyup : 3개중 하나만 구현
         */
        document.querySelector("#userInput").addEventListener("keyup",function(e) {
            //console.log(e);

            document.querySelector('.text-wrapper').innerHTML = this.value;
        });
    </script>

    <h2>submit Event</h2>
    <form action="">
        <fieldset>
            <legend>로그인</legend>
            <table>
                <tr>
                    <th>
                        <label for="userId">아이디</label>
                    </th>
                    <td>
                        <input type="text" name="userId" id="userId" placeholder="userId">
                    </td>
                </tr>
                <tr>
                    <th>
                        <label for="pwd">비밀번호</label>
                    </th>
                    <td>
                        <input type="password" name="pwd" id="pwd">
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: center;">
                        <input type="submit" value="로그인">
                    </td>
                </tr>
            </table>
        </fieldset>
    </form>
    <script>
        /**
         * 사용자 입력값 유효성검사
         */
        document.querySelector('form').onsubmit = function(e) {
            console.log(e);
            //1. 아이디검사
            if(userId.value.length < 4){
                alert('유효한 아이디를 입력하세요');
                userId.select(); //focus()
                return false; //submit이벤트 방지
            }

            //2. 비번검사
            if(pwd.value.length < 4) {
                alert('유효한 비밀번호를 입력하세요');
                pwd.select();
                return false;
            }

            //위의 유효성검사를 통과했다면 submit할수있다
            return true; //생략가능
        };
    </script>
    
    <h2>Event Propagation - Bubbling</h2>
    <div class="boxx box1" data-text="box1" onclick="displayMsg(event, this);">
        <div class="boxx box2" data-text="box2" onclick="displayMsg(event, this);">
            <div class="boxx box3" data-text="box3" onclick="displayMsg(event, this);"></div>
        </div>
    </div>
    <style>
        .boxx {
            border: 1px solid black;
            padding: 20px;

        }
        .box1 {
            background-color: blue;
        }
        .box2 {
            background-color: blueviolet;
        }
        .box3 {
            background-color: cadetblue;
        }
    </style>
    <script>

        function displayMsg(e, boxx) {
            console.log(boxx); //div태그
            console.log(e);
            console.log(boxx.dataset.text);

            //전파방지(부모태그까지 올라가는것방지)
            e.stopPropagation();
        }
    </script>
</body>
</html>